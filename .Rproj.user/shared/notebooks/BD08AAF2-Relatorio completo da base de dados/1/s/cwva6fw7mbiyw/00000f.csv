"0","# Criar lista para armazenar os outputs a serem apresentados"
"0","output <- tagList()"
"0","# Iterar por empreendimento"
"0","for (empreendimento.c in caminhos.relatorio_l$Empreendimentos) {"
"0","  # Adicionar título"
"0","  output <-"
"0","    tagAppendChild("
"0","      output,"
"0","      tags$h1(paste0("
"0","        match("
"0","          empreendimento.c,"
"0","          caminhos.relatorio_l$Empreendimentos"
"0","        ),"
"0","        "". "","
"0","        empreendimento.c"
"0","      ))"
"0","    )"
"0","  # Iterar por tipos de relatório"
"0","  tipos_vc <-"
"0","    names(caminhos.relatorio_l[!names(caminhos.relatorio_l) %in%"
"0","      c(""Empreendimentos"", ""Contagem"")])"
"0","  for (t in seq_along(tipos_vc)) {"
"0","    # Adicionar subtítulo"
"0","    output <- tagAppendChild(output, tags$h2(tipos_vc[t]))"
"0","    # Iterar por quantidade de relatórios de um mesmo tipo"
"0","    for (i in seq_along(caminhos.relatorio_l[[t]][[empreendimento.c]])) {"
"0","      # Extrair e formatar subsubtítulos"
"0","      subsubtitulo_vc <-"
"0","        basename(caminhos.relatorio_l[[t]][[empreendimento.c]][i]) %>%"
"0","        str_sub(1, 6) %>%"
"0","        paste0(""01"") %>%"
"0","        as.Date(format = ""%Y%m%d"") %>%"
"0","        format(""%Y-%m"") %>%"
"0","        unname()"
"0","      # Adicionar subsubtítulo"
"0","      output <- tagAppendChild(output, tags$h3(subsubtitulo_vc))"
"0","      # Adicionar gráfico de valor creditado x valor do empréstimo"
"0","      ig.vcxve <- ig_vcxve(dados.relatorio_l)"
"0","      output <- tagAppendChild(output, ig.vcxve)"
"0","      # Renderizar tabela do empreendimento como kable()"
"0","      empreendimento_t <-"
"0","        dados.relatorio_l[[empreendimento.c]][[t]][[i]]$Empreendimento %>%"
"0","        kable() %>%"
"0","        kable_styling("
"0","          full_width = FALSE,"
"0","          bootstrap_options = c(""bordered""),"
"0","          position = ""left"""
"0","        )"
"0","      # Acrescentar título da tabela do empreendimento"
"0","      output <- tagAppendChild(output, tags$h4(""[Tabela] Empreendimento""))"
"0","      # Converter kable para HTML e acrescentar objeto ao output"
"0","      output <- tagAppendChild(output, HTML(as.character(empreendimento_t)))"
"0","      # Renderizar tabela do empréstimo como kable()"
"0","      emprestimo_t <-"
"0","        dados.relatorio_l[[empreendimento.c]][[t]][[i]]$Emprestimo %>%"
"0","        mutate(across("
"0","          where(is.numeric),"
"0","          ~ number_format("
"0","            accuracy = 0.01,"
"0","            big.mark = ""."","
"0","            decimal.mark = "","""
"0","          )(.)"
"0","        )) %>%"
"0","        kable() %>%"
"0","        kable_styling("
"0","          full_width = FALSE,"
"0","          bootstrap_options = c(""bordered""),"
"0","          position = ""left"""
"0","        )"
"0","      # Acrescentar título da tabela do empreendimento"
"0","      output <- tagAppendChild(output, tags$h4(""[Tabela] Empréstimo""))"
"0","      # Converter kable para HTML e acrescentar objeto ao output"
"0","      output <- tagAppendChild(output, HTML(as.character(emprestimo_t)))"
"0","      # Renderizar a tabela das unidades como uma datatable()"
"0","      unidades_t <-"
"0","        tagList("
"0","          tags$h4(""[Tabela] Unidades""),"
"0","          dados.relatorio_l[[empreendimento.c]][[t]][[i]]$Unidades %>%"
"0","            mutate(across("
"0","              where(is.numeric),"
"0","              ~ number_format("
"0","                accuracy = 0.01,"
"0","                big.mark = ""."","
"0","                decimal.mark = "","""
"0","              )(.)"
"0","            )) %>%"
"0","            datatable("
"0","              options = list(pageLength = 5, class = ""cell-border"")"
"0","            )"
"0","        )"
"0","      # Gráfico: Unidades - Histograma do financiamento"
"0","      unidades_g <-"
"0","        ggplot("
"0","          data = dados.relatorio_l[[empreendimento.c]][[t]][[i]]$Unidades,"
"0","          aes(Financiamento)"
"0","        ) +"
"0","        geom_histogram("
"0","          color = ""black"","
"0","          fill = ""lightgray"""
"0","        ) +"
"0","        geom_vline(aes(xintercept = mean(Financiamento)),"
"0","          color = ""red"""
"0","        ) +"
"0","        xlab(""Financiamento (em R$)"") +"
"0","        scale_x_continuous(labels = scales::label_number("
"0","          big.mark = ""."","
"0","          decimal.mark = "","","
"0","          accuracy = 1"
"0","        )) +"
"0","        ylab(""Contagem"") +"
"0","        scale_y_continuous(labels = scales::label_number(accuracy = 1)) +"
"0","        theme_minimal()"
"0","      unidades_ig <- tagList("
"0","        tags$h4(""[Gráfico] Unidades: Financiamento""),"
"0","        ggplotly(unidades_g)"
"0","      )"
"0","      output <- tagAppendChild(output, unidades_t)"
"0","      output <- tagAppendChild(output, unidades_ig)"
"0","      # Renderizar a tabela de informações consolidadas como uma datatable()"
"0","      consolidado_t <-"
"0","        tagList("
"0","          tags$h4(""[Tabela] Informações consolidadas""),"
"0","          dados.relatorio_l[[empreendimento.c]][[t]][[i]]$Consolidado %>%"
"0","            mutate("
"0","              across("
"0","                where(is.numeric),"
"0","                ~ number_format("
"0","                  accuracy = 0.01,"
"0","                  big.mark = ""."","
"0","                  decimal.mark = "","""
"0","                )(.)"
"0","              )"
"0","            ) %>%"
"0","            datatable("
"0","              options = list(pageLength = 5, class = ""cell-border"")"
"0","            )"
"0","        )"
"0","      # Gráfico: Valor creditado x Valor do empréstimo"
"0","      # g_creditadoxemprestimo()"
"0","      # Gráfico: Consolidado -"
"0","      consolidado_gdf <-"
"0","        dados.relatorio_l[[empreendimento.c]][[t]][[i]]$Consolidado %>%"
"0","        summarise("
"0","          sum(`Valor Creditado`),"
"0","          sum(`Valor Desbloqueado`),"
"0","          sum(`Valor Amortizado`),"
"0","          sum(`Encargo Quitado do PJ`)"
"0","        ) %>%"
"0","        rbind(c("
"0","          ""Valor Creditado"","
"0","          ""Valor Desbloqueado"","
"0","          ""Valor Amortizado"","
"0","          ""Encargo Quitado do PJ"""
"0","        )) %>%"
"0","        t() %>%"
"0","        unname() %>%"
"0","        as.data.frame() %>%"
"0","        mutate("
"0","          Variavel = V2,"
"0","          Valor = V1 %>%"
"0","            as.numeric(),"
"0","          .keep = ""unused"""
"0","        )"
"0","      consolidado_g <-"
"0","        ggplot("
"0","          data = consolidado_gdf,"
"0","          aes("
"0","            x = Variavel,"
"0","            y = Valor"
"0","          )"
"0","        ) +"
"0","        geom_bar("
"0","          stat = ""identity"","
"0","          color = ""black"","
"0","          fill = ""lightgray"""
"0","        ) +"
"0","        geom_text("
"0","          aes(label = scales::label_comma("
"0","            big.mark = ""."","
"0","            decimal.mark = "","","
"0","            accuracy = 1"
"0","          )(Valor)),"
"0","          nudge_y = -20, size = 4"
"0","        ) +"
"0","        xlab("""") +"
"0","        ylab(""Valor (em R$)"") +"
"0","        scale_y_continuous(labels = scales::label_number("
"0","          big.mark = ""."","
"0","          decimal.mark = "","","
"0","          accuracy = 1"
"0","        )) +"
"0","        theme_minimal()"
"0","      consolidado_ig <- tagList("
"0","        tags$h4(""[Gráfico] Informações consolidadas""),"
"0","        ggplotly(consolidado_g)"
"0","      )"
"0","      output <- tagAppendChild(output, consolidado_t)"
"0","      output <- tagAppendChild(output, consolidado_ig)"
"0","    }"
"0","  }"
"0","}"
"2","Erro: objeto 'caminhos.relatorio_l' não encontrado
"
